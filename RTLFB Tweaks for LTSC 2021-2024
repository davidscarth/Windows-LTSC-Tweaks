# Windows Restricted Traffic Limited Functionality Baseline Tweaks v1.0
# for Windows 10 Enterprise LTSC 2021, Windows 11 Enterprise LTSC 2024
#
# First, install the Restricted Traffic Limited Functionality Baseline (for 2021 LTSC use 21H2_Win10\Enterprise. for 2024 LTSC use 24H2\Enterprise):
# https://docs.microsoft.com/en-us/windows/privacy/manage-connections-from-windows-operating-system-components-to-microsoft-services
# 
# Tip: You must put the LGPO.exe file into the LGPO folder: https://www.microsoft.com/en-us/download/details.aspx?id=55319, for the above GPO install script to work.
#      Then, when executing "RestrictedTraffic_ClientEnt_Install.cmd" you must specify the path to LGPO as an argument.
#      C:\>RestrictedTraffic_ClientEnt_Install.cmd "C:\Path\To\LGPO\Tools"
#
# Then, go into the Local Group Policy Editor ("gpedit.msc") and make the below adjustments manually:

# Re-enable Windows Update:
Administrative Templates\System\Internet Communication Management\Internet Communication settings
    Turn off access to all Windows Update features (change from Enabled to Not Configured)
    Turn off Automatic Root Certificates Update (change from Enabled to Not Configured)
Administrative Templates\Windows Components\Windows Update
    Specify intranet Microsoft update service location (change from Enabled to Not Configured)
    Do not connect to any Windows Update Internet locations (change from Enabled to Not Configured)
    # Optional, this is a preference:
    Do not include drivers with Windows Updates (change from Not Configured to Enabled)

# Re-enable Windows Defender Antivirus signature updates:
Administrative Templates\Windows Components\Microsoft Defender Antivirus\Security Intelligence Updates
    Define file shares for downloading security intelligence updates (Enabled to Not Configured)
    Define the order of sources for downloading security intelligence updates (from Enabled to Not Configured)

# Turn time auto-update capability back on:
Administrative Templates\System\Windows Time Service\Time Providers
    Enable Windows NTP Client (change from Disabled to Enabled)

# Allow user to enable webcam and microphones:
Computer Configuration\Administrative Templates\Windows Components\App Privacy
    Let Windows apps access the camera (Enabled, change 'Default for all apps' from "Force Deny" to "User is in control")
    Let Windows apps access the microphone (Enabled, change 'Default for all apps' from "Force Deny" to "User is in control")

# Optional, Misc tweaks:
Administrative Templates\Windows Components\Internet Explorer\Internet Control Panel\Advanced Page
    Allow third-party browser extensions (change from Not Configured to Disabled)
    Always send Do Not Track header (change from Not Configured to Enabled)
    Turn on Enhanced Protected Mode (change from Not Configured to Enabled)
Administrative Templates\Windows Components\Software Protection Platform
    Control Device Reactivation for Retail devices (change from Not Configured to Disabled)
Computer Configuration\Administrative Templates\Windows Components\BitLocker Drive Encryption
    Choose drive encryption method and cipher strength (Windows 10 (Version 1511) and later) (change from Not Configured to Enabled)
    Choose drive encryption method and cipher strength (Windows 10 (Version 1511) and later) (change encryption method for 'Operating System' and 'Fixed Data Drives' to "XTS-AES 256-bit")
# Optional, Misc tweaks, Windows 11 only:
Administrative Templates\Windows Components\Windows AI
    Allow Recall to be enabled (change from Not Configured to Disabled)

# Optional, Re-enable Windows Store if desired (run "wsreset -i" from elevated command prompt to install Windows Store after changes are applied)
Computer Configuration\Administrative Templates\Windows Components\Store
    Disable all apps from Microsoft Store (change from Disabled to Not Configured)

# Once finished, reboot or run the following command in an elevated command prompt to apply changes:
    gpupdate /force
